# 研究室のパソコンにリモート接続しよう

## はじめに

モデルの学習のため"だけ"に学校に来ているのならそれは結構無駄な時間です。もちろん、他の用事があったりコミュニケーションも含めて来るのは構いませんし大切ですが、モデルの学習のため"だけ"ならばそれは無駄な時間なのでリモートで接続できるようにしましょう。

## OpenSSHサーバー

デフォルトでUbuntuには入っている場合が多いですが、一応入っているのか確認しておきましょう。

```
dpkg -l | grep openssh-server
```
で`openssh-server`と表示されれば入っています。入っていなければ

```
sudo apt update
sudo apt install openssh-server
```

でインストールしましょう。インストールしただけではサーバーは立ち上がりません。デーモン(常駐するプログラムのこと)が起動しているか確認しましょう。

```
sudo systemctl status ssh
```
起動していれば出力に`Active: active (running)`という文字列が含まれています。起動していなかったら
```
sudo service ssh start
```
で起動しましょう。

## ポートの確認

遠隔から別のパソコンにログインするにはIPアドレスとポート番号の2つのものが必要です。まずは、OpenSSHサーバーが何番ポートでログインを受け付けているのか確認しましょう。
```
sudo grep -w "Port" /etc/ssh/sshd_config
```
で確認できます。デフォルトでは22番ポートが受け付けているはずですが、確認してください。

## IPアドレスの確認

研究室のパソコンはDHCPサーバーからIPアドレスを取得しています。しかし、このDHCPという仕組みは割り当てられるIPアドレスが固定でないため、春山先生に固定してもらいましょう。DHCPサーバーの管理者は春山先生です。以下、固定したものだと思って話を勧めます。

現在のPCに割り当てられているIPアドレスを検索します。
```
ip addr
```
と入力しましょう。`enp3s0`といったものを探してください。それが2番だったとしましょう。2番の`inet ○○○.○○○.○○○.○○○`の○○○.○○○.○○○.○○○gがIPアドレスとなります。

## クライアントからsshで接続

特にわからなくても気にすることはないのですが、一応軽く湯おごを説明しておきます。(厳密な定義は違うのですが)リモートにあるパソコンを __ホスト__ 。手元にあるパソコンを __クライアント__ といいます。sshとはセキュア-シェルの略です。シェルとはカーネル(Linuxの頭脳のようなもの)をユーザーが触れるようにするためのインターフェースです。

クライアントは私のパソコンはwindowsなのでwindowsを想定して行います。ただし、どのOSでもほとんど変わらないと思います。

コマンドプロンプトを開いて、
```
ssh -p ポート番号 username@IPアドレス
```
と入力しましょう。パスワードの入力を求められます。以上でリモートから研究室のパソコンにアクセスができました。ここからDockerを立ち上げて、その中でJupyter labを立ち上げてモデルを学習させるなどの使い方ができます。

## Jupyter labの立ち上げ

後はいつもどおりです。cdコマンドでディレクトリを移動して`docker-compose up`で起動します。ここで注意点なのですが、普段は`http://127.0.0.1:8888/lab?token=トークン`といったURLにアクセスしていると思うのですが、リモートからここにアクセスするには、`http://研究室のパソコンのIPアドレス:8888?token=トークン`となります。